<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script type="module">
      import MyPromise from './my-promise.js';
      const task = async (time) => await new MyPromise((resolve) => setTimeout(() => resolve(time), time));
      /**
       * test promise的finally
       */
      // new MyPromise((resolve, reject) => {
      //   resolve(666);
      // })
      //   .then((res) => console.log('res===', res))
      //   .catch((error) => console.log('error', error))
      //   .finally((res) => {
      //     console.log('finaly==', res);
      //   });
      // new Promise((resolve, reject) => {
      //   reject(666);
      // })
      //   .then((res) => console.log('res===', res))
      //   .catch((error) => console.log('error', error))
      //   .finally((res) => {
      //     console.log('finaly--', res);
      //   });

      /**
       * test promise的race和all
       */
      MyPromise.race([task(1000), task(500), task(300)]).then((res) => {
        console.log('race === ', res);
      });
      // MyPromise.race([
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(1);
      //     }, 2000);
      //   }),
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(2);
      //     }, 1000);
      //   }),
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(3);
      //     }, 500);
      //   }),
      // ]).then((arr) => {
      //   console.log(arr); // [1, 2, 3]
      // });

      // Promise.race([
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(1);
      //     }, 2000);
      //   }),
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(2);
      //     }, 1000);
      //   }),
      //   new Promise(function (resolve, reject) {
      //     setTimeout(() => {
      //       resolve(3);
      //     }, 500);
      //   }),
      // ]).then((arr) => {
      //   console.log(arr); // [1, 2, 3]
      // });

      /**
       * test promise的链式调用
       */
      // new MyPromise((resolve, reject) => {
      //   // setTimeout(() => {
      //   resolve(666);
      //   // }, 2000);
      // })
      //   .then((res) => {
      //     return new MyPromise((resolve, reject) => {
      //       resolve(
      //         new MyPromise((resolve1, rej) => {
      //           resolve1(333);
      //         })
      //       );
      //     });
      //   })
      //   .then(
      //     (res1) => {
      //       console.log('res1===', res1);
      //     },
      //     (err1) => {
      //       console.log('err1===', err1);
      //     }
      //   );

      // new Promise((resolve, reject) => {
      //   setTimeout(() => {
      //     resolve(666);
      //   }, 2000);
      // })
      //   .then((res) => {
      //     return new Promise((resolve, reject) => {
      //       resolve(
      //         new Promise((resolve1, rej) => {
      //           resolve1(555);
      //         })
      //       );
      //     });
      //   })
      //   .then(
      //     (res1) => {
      //       console.log('res1===', res1);
      //     },
      //     (err1) => {
      //       console.log('err1===', err1);
      //     }
      //   );
    </script>
  </body>
</html>
